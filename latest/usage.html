

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Input requirements &mdash; linesink-maker 0.1.2.post8.dev0+g4c7b201 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API reference" href="api/index.html" />
    <link rel="prev" title="Examples of using the lsmaker.utils module to export and visualize results from a GFLOW simulation" href="notebooks/GFLOW_results_visualization.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> linesink-maker
          

          
          </a>

          
            
            
              <div class="version">
                0.1.2.post8.dev0+g4c7b201
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="philosophy.html">Philosophy</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Input requirements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nhdplus-files">NHDPlus files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#model-domain-specification">Model domain specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#line-simplification">Line simplification</a></li>
<li class="toctree-l2"><a class="reference internal" href="#other-inputs">Other inputs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#creating-the-yaml-input-file-for-linesink-maker">Creating the YAML Input file for Linesink-maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="#running-linesink-maker">Running Linesink-maker</a></li>
<li class="toctree-l1"><a class="reference internal" href="#diagnosing-errors">Diagnosing errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#importing-the-linesink-string-file-into-gflow">Importing the linesink string file into GFLOW</a></li>
<li class="toctree-l1"><a class="reference internal" href="#viewing-the-linesinkdata-in-a-gis">Viewing the LinesinkData in a GIS</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/index.html"> Code Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="config-file-defaults.html"> Configuration defaults</a></li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html"> Release History</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to linesink-maker</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">linesink-maker</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Input requirements</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/usage.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="input-requirements">
<h1>Input requirements<a class="headerlink" href="#input-requirements" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All shapefile input should include projection information (<code class="docutils literal notranslate"><span class="pre">\*.prj</span></code> files), and be in a standard coordinate reference system that is well known (for example, by a valid EPSG identifier). CRS units of feet are not recommended!</p>
</div>
<div class="section" id="nhdplus-files">
<h2>NHDPlus files<a class="headerlink" href="#nhdplus-files" title="Permalink to this headline">¶</a></h2>
<p>For each major drainage area encompassed by the model (e.g. Area 04 representing the Great Lakes Basin, 07 representing the Upper Mississippi Basin, etc):</p>
<ul class="simple">
<li><p>NHDFlowline.shp</p></li>
<li><p>NHDWaterbody.shp</p></li>
<li><p>elevslope.dbf</p></li>
<li><p>PlusFlowlineVAA.dbf</p></li>
</ul>
<p>These are available at: &lt;<a class="reference external" href="http://www.horizon-systems.com/nhdplus/NHDPlusV2_data.php">http://www.horizon-systems.com/nhdplus/NHDPlusV2_data.php</a>&gt;  in the <strong>`NHDPlusV21_GL_04_NHDSnapshot_07.7z`</strong> and <strong>`NHDPlusV21_GL_04_NHDPlusAttributes_08.7z`</strong>
downloads. The NHDPlus files are specified in the YAML input file under the <code class="docutils literal notranslate"><span class="pre">flowlines:</span></code>, <code class="docutils literal notranslate"><span class="pre">elevslope:</span></code>, <code class="docutils literal notranslate"><span class="pre">PlusFlowVAA:</span></code> and <code class="docutils literal notranslate"><span class="pre">waterbodies:</span></code> keys, as illustrated in the <a class="reference external" href="https://aleaf.github.io/linesink-maker/medford.html">Medford National Forest Unit example</a>.</p>
</div>
<div class="section" id="model-domain-specification">
<h2>Model domain specification<a class="headerlink" href="#model-domain-specification" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><strong>shapefile of the model nearfield area</strong> (where LinesinkData will be routed and have resistance) <strong>(required)</strong></p></li>
<li><p><strong>shapefile of the model farfield area</strong> (where LinesinkData will be zero-resistance and not routed) (<strong>optional</strong>; if no farfield shapefile is provided, a buffer is drawn around the provided nearfield. The default for this buffer is 10,000 basemap units. Alternatively, the size of the buffer can be specified in the YAML input file under the <code class="docutils literal notranslate"><span class="pre">farfield_buffer:</span></code> key.</p></li>
<li><p>in addition, a <strong>third shapefile</strong> defining an intermediate area with routed, resistance LinesinkData can be supplied with the <code class="docutils literal notranslate"><span class="pre">routed_area:</span></code> key. This allows for 3 levels of line simplification, with the most detail limited to the immediate nearfield.</p></li>
</ul>
</div>
<div class="section" id="line-simplification">
<h2>Line simplification<a class="headerlink" href="#line-simplification" title="Permalink to this headline">¶</a></h2>
<p>Linesink-maker uses the line simplification algorithm in the shapely package to reduce the vertices in the NHDPlus GIS flowline coverages so that a reasonable number of LinesinkData are produced. Vertices are removed until the simplified line deviates from the original line by a specified distance tolerance. Tolerances for the model nearfield and farfield areas are specified in the YAML input file (<code class="docutils literal notranslate"><span class="pre">nearfield_tolerance:</span></code> and <code class="docutils literal notranslate"><span class="pre">farfield_tolerance:</span></code>). The user may want to adjust these values depending on the desired level of detail for the model, and the constraint of keeping the linesink equations beneath the maxmimum for GFLOW. Reasonable starting values are 100-200 m for the nearfield, and 300-500 m for the farfield.</p>
</div>
<div class="section" id="other-inputs">
<h2>Other inputs<a class="headerlink" href="#other-inputs" title="Permalink to this headline">¶</a></h2>
<p>Other options, such as minimum lake size and minimum stream order to retain in the model farfield, may be specified in the YAML input file.</p>
</div>
</div>
<div class="section" id="creating-the-yaml-input-file-for-linesink-maker">
<h1>Creating the YAML Input file for Linesink-maker<a class="headerlink" href="#creating-the-yaml-input-file-for-linesink-maker" title="Permalink to this headline">¶</a></h1>
<p>The above inputs and other settings are specified in a configuration file using the <a class="reference external" href="yaml.org">YAML format</a>, which maps <code class="docutils literal notranslate"><span class="pre">key:</span> <span class="pre">value</span></code> pairs similar to a Python dictionary. See the <a class="reference internal" href="example_medford.html#medford-national-forest-unit"><span class="std std-ref">Medford National Forest Unit</span></a> example for more details for more details on how to make a configuration file. An editor that supports YAML code highlighting, such as <a class="reference external" href="https://code.visualstudio.com/">VS Code</a>, <a class="reference external" href="https://www.barebones.com/products/bbedit/">BBEdit</a> or <a class="reference external" href="https://www.sublimetext.com/">Sublime Text</a> is highly recommended. A <a class="reference internal" href="config-file-defaults.html#default-configuration-settings-for-linesink-maker"><span class="std std-ref">default configuration file</span></a> contains a more comprehensive listing of settings and default values that are used for any variables not specified by the user.</p>
</div>
<div class="section" id="running-linesink-maker">
<h1>Running Linesink-maker<a class="headerlink" href="#running-linesink-maker" title="Permalink to this headline">¶</a></h1>
<p>Linesink-maker can be run with the following python script by replacing <code class="docutils literal notranslate"><span class="pre">'Medford_lines.yml'</span></code> with the name of your configuration file.</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lsmaker</span>

<span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;Medford_lines.yml&#39;</span>
<span class="n">ls</span> <span class="o">=</span> <span class="n">lsmaker</span><span class="o">.</span><span class="n">LinesinkData</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>
<span class="n">ls</span><span class="o">.</span><span class="n">make_linesinks</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>Which can be executed at the command line with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">make_linesinks</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
</div>
<div class="section" id="diagnosing-errors">
<h1>Diagnosing errors<a class="headerlink" href="#diagnosing-errors" title="Permalink to this headline">¶</a></h1>
<p>After making the Linesinks, Linesink-maker runs the <a class="reference internal" href="api/index.html#lsmaker.lsmaker.LinesinkData.run_diagnostics" title="lsmaker.lsmaker.LinesinkData.run_diagnostics"><code class="xref py py-meth docutils literal notranslate"><span class="pre">run_diagnostics()</span></code></a> method, which checks for common issues such as zero gradients (in streambed), duplicate vertices, and linesinks that cross one another (a common side-effect of simplification). Results of the diagnostics are reported in file specified under the <code class="docutils literal notranslate"><span class="pre">error_reporting:</span></code> option in the configuration file (which defaults to <strong>linesinkMaker_errors.txt</strong>). Errors are generally referenced by NHDPlus COMID, allowing users to visualize the errors by importing the linesink shapefile into a GIS environment (see below). The errors can then be resolved either in the input linework, or within the GFLOW GUI after importing the lines.</p>
</div>
<div class="section" id="importing-the-linesink-string-file-into-gflow">
<h1>Importing the linesink string file into GFLOW<a class="headerlink" href="#importing-the-linesink-string-file-into-gflow" title="Permalink to this headline">¶</a></h1>
<p>Linesink-maker outputs a linesink string file named <strong>&lt;basename&gt;.lss.xml</strong>, where <cite>basename</cite> is the name specified under the <code class="docutils literal notranslate"><span class="pre">outfile_basename:</span></code> option in the configuration file (default <strong>‘Model’</strong>). The steps for importing the linesinks into GFLOW are summarized below. Additional details are available in the GFLOW documentation.</p>
<ol class="arabic simple">
<li><p>Create a new GFLOW database</p></li>
<li><p>Make sure the computational and GIS units are properly specified within the GFLOW GUI</p></li>
<li><p>Then within the GFLOW GUI, from the <cite>Tools</cite> menu, select <cite>Import &gt; Line-sink Strings</cite>.</p></li>
</ol>
</div>
<div class="section" id="viewing-the-linesinkdata-in-a-gis">
<h1>Viewing the LinesinkData in a GIS<a class="headerlink" href="#viewing-the-linesinkdata-in-a-gis" title="Permalink to this headline">¶</a></h1>
<p>Linesink-maker also outputs a shapefile representation of the linesink network (<strong>&lt;basename&gt;.shp</strong>), for visualization in a GIS. For an example, see <strong>Medford.shp</strong> after running the <a class="reference internal" href="example_medford.html#medford-national-forest-unit"><span class="std std-ref">Medford National Forest Unit</span></a> example.</p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="api/index.html" class="btn btn-neutral float-right" title="API reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="notebooks/GFLOW_results_visualization.html" class="btn btn-neutral float-left" title="Examples of using the lsmaker.utils module to export and visualize results from a GFLOW simulation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
      <span class="lastupdated">
        Last updated on Jan 28, 2021.
      </span>

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>